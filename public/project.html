<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Crowdspace | Project details</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./styles/base.css" />
    <link rel="stylesheet" href="./styles/projects.css" />
    <link rel="stylesheet" href="./styles/people.css" />
    <link rel="stylesheet" href="./styles/admin.css" />
  </head>
  <body>
    <header class="site-header">
      <div class="container">
        <div class="branding">
          <span class="logo" onclick="window.location.href='./index.html'" style="cursor: pointer;">Crowdspace</span>
          <p class="tagline">Project overview and backer contributions.</p>
        </div>
        <nav class="primary-nav">
          <a class="nav-link" href="./projects.html">Campaigns</a>
          <a class="nav-link" href="./creators.html">Creators</a>
          <a class="nav-link nav-link-backers" href="./backers.html">Backers</a>
          <span class="admin-indicator">Admin</span>
        </nav>
      </div>
    </header>

    <main>
      <section class="section projects-hero-section project-hero-with-bg">
        <div class="hero-bg-image" id="hero-bg-image"></div>
        <div class="hero-bg-overlay"></div>
        <div class="container">
          <div class="profile-hero">
            <p class="eyebrow">Project</p>
            <h1 id="project-title" class="profile-title"></h1>
            <p id="project-tagline" class="profile-subtitle"></p>
          </div>
        </div>
      </section>

      <section class="section">
        <div class="container section-content" id="project-profile-root">
          <div class="project-profile-grid">
            <div class="project-info-column">
              <a id="project-external-link" class="profile-back-link" href="projects.html">
                <span class="profile-back-icon" aria-hidden="true"></span>
                <span id="project-external-text">Browse all campaigns</span>
              </a>
              <div class="profile-details-card">
                <div class="profile-details-grid">
                  <div class="detail-item">
                    <span class="detail-icon">üë§</span>
                    <span class="detail-label">Creator</span>
                    <a id="project-creator-link" href="#" class="detail-value detail-link"></a>
                  </div>
                  <div class="detail-item">
                    <span class="detail-icon">üöÄ</span>
                    <span class="detail-label">Platform</span>
                    <span id="project-platform" class="detail-value"></span>
                  </div>
                  <div class="detail-item">
                    <span class="detail-icon">üìä</span>
                    <span class="detail-label">Status</span>
                    <span id="project-status" class="detail-value"></span>
                  </div>
                  <div class="detail-item">
                    <span class="detail-icon">üè∑Ô∏è</span>
                    <span class="detail-label">Category</span>
                    <span id="project-category" class="detail-value"></span>
                  </div>
                  <div class="detail-item">
                    <span class="detail-icon">üìÖ</span>
                    <span class="detail-label">Dates</span>
                    <span id="project-dates" class="detail-value"></span>
                  </div>
                </div>
              </div>

              <section class="project-content-section project-funding-section">
                <h2>Funding Progress</h2>
                <div id="project-funding" class="funding-stats"></div>
                <div class="funding-progress" aria-label="Funding progress">
                  <div class="funding-progress-track">
                    <div
                      class="funding-progress-bar"
                      id="project-funding-progress"
                      role="img"
                      aria-label="Project funding progress bar"
                    ></div>
                  </div>
                  <span class="funding-progress-label" id="project-funding-percent"></span>
                </div>
                <div class="project-actions">
                  <button type="button" class="project-edit-btn" id="project-edit-btn">
                    Edit project
                  </button>
                  <button type="button" class="project-delete-btn" id="project-delete-btn">
                    Delete project
                  </button>
                </div>
                <p id="project-action-status" class="project-action-status" aria-live="polite"></p>
              </section>
            </div>

            <div class="project-main-column">
              <section class="project-content-section">
                <h2>Overview</h2>
                <p id="project-description" class="project-description-text"></p>
              </section>

              <section class="project-content-section">
                <div class="section-header">
                  <h2>Recent Backers</h2>
                  <button type="button" class="edit-btn" id="edit-backers-btn" title="Edit backers">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/>
                      <path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/>
                    </svg>
                  </button>
                </div>
                <div id="project-backers-list" class="backers-grid"></div>
                <p id="project-backers-empty" class="empty-state">No backer contributions recorded yet.</p>
              </section>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- Edit Backers Modal -->
    <div id="edit-backers-modal" class="modal-overlay">
      <div class="modal">
        <div class="modal-header">
          <h3>Edit Recent Backers</h3>
          <button type="button" class="modal-close" id="edit-backers-close">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 6L6 18M6 6l12 12"/>
            </svg>
          </button>
        </div>
        <div class="modal-body">
          <div id="edit-backers-status" class="status-message" style="display: none;"></div>
          
          <div id="edit-backers-list" class="backer-edit-list">
            <!-- Populated dynamically -->
          </div>

          <div class="add-backer-section">
            <h4>Add a backer</h4>
            <div class="add-backer-tabs">
              <button type="button" class="add-backer-tab active" data-tab="existing">Select existing</button>
              <button type="button" class="add-backer-tab" data-tab="new">Create new</button>
            </div>
            
            <div id="panel-existing" class="add-backer-panel active">
              <div class="add-backer-form">
                <div class="form-group">
                  <label for="existing-backer-select">Select backer</label>
                  <select id="existing-backer-select" class="form-group input">
                    <option value="">-- Choose a backer --</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="existing-backer-amount">Pledge amount ($)</label>
                  <input type="number" id="existing-backer-amount" min="1" step="1" placeholder="100" />
                </div>
                <button type="button" class="btn btn-secondary btn-sm" id="add-existing-backer-btn">Add to project</button>
              </div>
            </div>
            
            <div id="panel-new" class="add-backer-panel">
              <div class="add-backer-form">
                <div class="add-backer-row">
                  <div class="form-group">
                    <label for="new-backer-name">Name *</label>
                    <input type="text" id="new-backer-name" placeholder="Enter name" required />
                  </div>
                  <div class="form-group">
                    <label for="new-backer-email">Email</label>
                    <input type="email" id="new-backer-email" placeholder="Enter email" />
                  </div>
                </div>
                <div class="add-backer-row">
                  <div class="form-group">
                    <label for="new-backer-country">Country</label>
                    <input type="text" id="new-backer-country" placeholder="Enter country" />
                  </div>
                  <div class="form-group">
                    <label for="new-backer-amount">Pledge amount ($) *</label>
                    <input type="number" id="new-backer-amount" min="1" step="1" placeholder="100" required />
                  </div>
                </div>
                <button type="button" class="btn btn-secondary btn-sm" id="add-new-backer-btn">Create & add to project</button>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" id="edit-backers-cancel">Cancel</button>
          <button type="button" class="btn btn-primary" id="edit-backers-save">Save changes</button>
        </div>
      </div>
    </div>

    <!-- Edit Project Modal -->
    <div id="edit-project-modal" class="modal-overlay">
      <div class="modal modal-lg">
        <div class="modal-header">
          <h3>Edit Project</h3>
          <button type="button" class="modal-close" id="edit-project-close">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 6L6 18M6 6l12 12"/>
            </svg>
          </button>
        </div>
        <div class="modal-body">
          <form id="edit-project-form" class="edit-project-form">
            <div class="form-grid">
              <div class="form-group">
                <label for="edit-title">Title *</label>
                <input type="text" id="edit-title" name="title" required />
              </div>
              <div class="form-group">
                <label for="edit-category">Category</label>
                <select id="edit-category" name="category">
                  <option value="">Select category</option>
                  <option value="Environment">Environment</option>
                  <option value="Technology">Technology</option>
                  <option value="Education">Education</option>
                  <option value="Art">Art</option>
                  <option value="Health">Health</option>
                  <option value="Games">Games</option>
                </select>
              </div>
              <div class="form-group">
                <label for="edit-platform">Platform *</label>
                <select id="edit-platform" name="platform" required>
                  <option value="kickstarter">Kickstarter</option>
                  <option value="indiegogo">Indiegogo</option>
                  <option value="gofundme">GoFundMe</option>
                </select>
              </div>
              <div class="form-group">
                <label for="edit-status">Status *</label>
                <select id="edit-status" name="status" required>
                  <option value="going">Going</option>
                  <option value="completed">Completed</option>
                  <option value="upcoming">Upcoming</option>
                </select>
              </div>
              <div class="form-group">
                <label for="edit-launch-date">Launch Date</label>
                <input type="date" id="edit-launch-date" name="launch_date" />
              </div>
              <div class="form-group">
                <label for="edit-end-date">End Date</label>
                <input type="date" id="edit-end-date" name="end_date" />
              </div>
              <div class="form-group">
                <label for="edit-goal-amount">Goal Amount ($)</label>
                <input type="number" id="edit-goal-amount" name="goal_amount" min="0" step="0.01" />
              </div>
              <div class="form-group">
                <label for="edit-url">Campaign URL *</label>
                <input type="url" id="edit-url" name="url" required autocomplete="off" />
              </div>
            </div>
            <div class="form-group form-group-full">
              <label for="edit-description">Description *</label>
              <textarea id="edit-description" name="description" rows="4" required></textarea>
            </div>
            <div class="form-group form-group-full">
              <label for="edit-image">Project Image</label>
              <div class="edit-image-preview" id="edit-image-preview"></div>
              <input type="file" id="edit-image" name="image" accept="image/jpeg,image/jpg,image/png,image/gif,image/webp" />
              <span class="file-hint">Leave empty to keep current image. Max 5MB. Supported: JPG, PNG, GIF, WebP</span>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" id="edit-project-cancel">Cancel</button>
          <button type="button" class="btn btn-primary" id="edit-project-save">Save changes</button>
        </div>
      </div>
    </div>

    <footer class="site-footer">
      <div class="container">
        <div class="footer-left">
          <p>&copy; <span id="year"></span> xqsy</p>
          <a class="footer-admin-link" href="./admin-login.html">Login</a>
        </div>
        <a class="nav-link" href="https://github.com/xqsy">GitHub</a>
      </div>
    </footer>

    <script src="./scripts/base.js"></script>
    <script src="./scripts/utils.js"></script>
    <script src="./scripts/admin-shared.js"></script>
    <script src="./scripts/project-detail.js"></script>
    <script src="./scripts/edit-backers.js"></script>
  </body>
</html>
